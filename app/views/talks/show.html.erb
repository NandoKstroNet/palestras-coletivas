<div>
  <% if @talk %>
    <h2 class="text-info"><%= @talk.title %></h2>

    <% if Rails.env != 'test' %>
      <% unless @talk.code.empty? %>
        <iframe src="http://www.slideshare.net/slideshow/embed_code/<%= @talk.code %>" width="427" height="356" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px" allowfullscreen webkitallowfullscreen mozallowfullscreen> </iframe>
      <% else %>
        <br/>
        <h4><p class="text-warning"><%= t("show.talk.without_presentation") %></p></h4>
      <% end %>
      <br/>
    <% end %>
    
    <% if logged_in? %>
      <% if current_user.watched_talk? @talk %>
        <%= link_to t("labels.talk.watched"), unwatch_talk_path(@talk), :class => "btn btn-primary" %>
      <% else %>
        <%= link_to t("labels.talk.not_watched"), watch_talk_path(@talk), :class => "btn btn-danger" %>
      <% end %>

      <% @talk.users.each do |user| %>
        <% if current_user.id.to_s == user.id.to_s && @talk.owner.to_s == user.id.to_s %>
          <%= link_to t("titles.talks.edit"), edit_talk_path(@talk), :class => "btn btn-primary" %>
          <br/><br/>
        <% end %>
      <% end %>
    <% end %>

    <p>
      <strong><%= t("labels.talk.description") %></strong><br/>
      <p class="text-info"><%= simple_format @talk.description %></p>
    </p>

    <p>
      <strong><%= t("labels.talk.tags") %>:</strong> <%= @talk.tags %>
    </p>

    <% if logged_in? %>
      <% @talk.users.each do |user| %>
        <% if user.id == current_user.id %>
          <p>
            <strong><%= t("show.talk.to_public") %>:</strong> <%= @talk.to_public ? t("show.talk._yes") : t("show.talk._no") %>
          </p>
        <% end %>
      <% end %>
    <% end %>

    <% if @talk.watched_users.any? %>
      <h4>
        <%= t("labels.talk.who_watched") %>
        <small>
          (<%= pluralize(@talk.watched_users.size, t("labels.general.person").downcase) %>)
        </small>
      </h4>
      <% @talk.watched_users.each do |user| %>
        <span class="watched_user"><%= render "shared/user_thumb", :user => user %></span>
      <% end %>  <br/><br/>
    <% end %>

    <h4><%= t("show.talk.created_by") %></h4>

    <% @talk.users.by_name.each do |user| %>
      <%= render "shared/user", :user => user %><br/><br/>
    <% end %>

    <% if @talk.schedules? %>
      <% event = t("show.talk.events") %>
      <h4><%= event[@talk.schedules.count > 1 ? :other : :one] %></h4>

      <% @talk.schedules.each do |schedule| %>
          <h5><%= link_to "#{schedule.event.name} - #{schedule.event.edition}", event_path(schedule.event), :target => "_blank" %></h5>
      <% end %>
    <% end %>
  <% else %>
    <h1><%= t("show.talk.not_public") %></h1>
  <% end %>
</div>